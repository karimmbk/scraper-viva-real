// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0
(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"NF/L":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return J}));var n=r("lwsE"),a=r.n(n),o=r("W8MJ"),i=r.n(o),s=r("7W2i"),u=r.n(s),l=r("a1gu"),c=r.n(l),p=r("Nsbk"),h=r.n(p),f=r("lSNA"),d=r.n(f),y=r("WjpJ"),v=r.n(y),m=r("17x9"),M=r.n(m),g=r("q1tI"),b=r.n(g),R=r("20nU"),k=r("U+yc"),O=r.n(k),U=r("CB4y"),D=r("Y+p1"),C=r.n(D);var x,_,w=r("U7ah");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}function Y(e,t,r,n,a,o,i){if(e&&e.getContext&&t){var s=e.getContext("2d");if(s){s.fillStyle="#FFF";var u=Object(w.a)(),l=r/(u-a+1),c=0;for(var p in t)void 0!==t[p]&&(c=Math.max(c,Math.max.apply(null,t[p])));if(function(e){var t=0,r=1e3;for(var n in e)void 0!==e[n]&&(t=Math.max(t,Math.max.apply(null,e[n])),r=Math.min(r,Math.min.apply(null,e[n].filter(Boolean))));return Math.log1p(t)-Math.log1p(r)>3}(t)){var h=function(e,t){var r=[];for(var n in e)e[n]&&(r[n]=e[n].map(Math.log1p));return[r,Math.log1p(t)]}(t,c);t=h[0],c=h[1]}for(var f=n/c,d=a;d<=u;d++){var y=Math.ceil((d-a)*l),v=Math.ceil((d-a+1)*l);s.beginPath(),s.moveTo(y+.5,0),s.lineTo(y+.5,n),s.lineWidth=1,s.strokeStyle="#CCC",s.stroke();var m=y+1;if(d===o&&(s.fillStyle="#FFFFA5",s.fillRect(m,0,v-y-.5,n+.5)),void 0!==t[d])for(var M=(v-m)/12,g=0;g<12;g++){var b=t[d][g];if(b>0){var R=Math.ceil(b*f);s.fillStyle=d===o&&g===i?"#EC008C":"#000",s.fillRect(Math.round(m),Math.ceil(n-R),Math.ceil(M),Math.round(R))}m+=M}}}}}var W,q,B=(_=function(e){u()(r,e);var t=E(r);function r(e){var n;return a()(this,r),(n=t.call(this,e))._canvas=b.a.createRef(),n}return i()(r,[{key:"getDateByMouseEvent",value:function(e){var t,r,n,a=this.props,o=a.firstYear,i=a.imgWidth,s=a.monthWidth,u=a.yearWidth,l=Math.round((t=e.target,r=t.getBoundingClientRect(),n=document.documentElement,n="number"==typeof(n=n||document.body.parentNode).scrollTop?n:document.body,{top:r.top+n.scrollTop,bottom:r.bottom+n.scrollTop,left:r.left+n.scrollLeft,right:r.right+n.scrollLeft}).left),c=Math.min(Math.max(0,e.pageX-l),i),p=c%u;return{year:Math.floor(c/u)+o,month:Math.min(Math.floor(p/s),11)+1,day:p%s>s/2?15:1}}},{key:"handleMouseMove",value:function(e){this.props.onMouseOverDate(this.getDateByMouseEvent(e))}},{key:"handleMouseUp",value:function(e){this.props.onMouseUpDate(this.getDateByMouseEvent(e))}},{key:"componentDidMount",value:function(){this.renderCanvas(this.props)}},{key:"componentDidUpdate",value:function(){this.renderCanvas(this.props)}},{key:"shouldComponentUpdate",value:function(e){return C()(this.props,e)||this.renderCanvas(e),!1}},{key:"render",value:function(){var e=this.props,t=e.imgWidth,r=e.imgHeight;return b.a.createElement("canvas",{className:"sparkline-canvas",ref:this._canvas,width:t,height:r,alt:"sparklines",onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp})}},{key:"renderCanvas",value:function(e){!function(e){if(e&&e.getContext){var t=e.getContext("2d",{alpha:!1});t&&(t.fillStyle="#f0f0f0",t.fillRect(0,0,e.width,e.height))}}(this._canvas.current),Y(this._canvas.current,e.distribution,e.imgWidth,e.imgHeight,e.firstYear,e.selectedYear)}}]),r}(b.a.Component),d()(_,"displayName","SparklineCanvas"),d()(_,"propTypes",{distribution:M.a.object,firstYear:M.a.number,imgHeight:M.a.number,imgWidth:M.a.number,monthWidth:M.a.number,onMouseOverDate:M.a.func.isRequired,onMouseUpDate:M.a.func.isRequired,selectedYear:M.a.number,yearWidth:M.a.number}),x=_,O()(x.prototype,"handleMouseMove",[U.bind],Object.getOwnPropertyDescriptor(x.prototype,"handleMouseMove"),x.prototype),O()(x.prototype,"handleMouseUp",[U.bind],Object.getOwnPropertyDescriptor(x.prototype,"handleMouseUp"),x.prototype),x);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var P=(q=function(e){u()(r,e);var t=N(r);function r(){return a()(this,r),t.apply(this,arguments)}return i()(r,[{key:"handleMouseOver",value:function(){this.props.onMouseOver({year:this.props.year,month:1,day:1})}},{key:"_handleMouseUp",value:function(){this.props.onMouseUpDate({year:this.props.year,month:1,day:1})}},{key:"render",value:function(){var e=this.props,t=e.highlighted,r=e.selected,n=e.year,a="sparkline-year-label";return r?a+=" selected-year":t&&(a+=" highlighted-year"),b.a.createElement("span",{className:a,onMouseOver:this.handleMouseOver,onMouseUp:this._handleMouseUp},n)}}]),r}(b.a.PureComponent),d()(q,"displayName","SparklineYearLabel"),d()(q,"propTypes",{highlighted:M.a.bool.isRequired,selected:M.a.bool.isRequired,url:M.a.string.isRequired,onMouseOver:M.a.func.isRequired,onMouseUpDate:M.a.func.isRequired,year:M.a.number.isRequired}),W=q,O()(W.prototype,"handleMouseOver",[U.bind],Object.getOwnPropertyDescriptor(W.prototype,"handleMouseOver"),W.prototype),O()(W.prototype,"_handleMouseUp",[U.bind],Object.getOwnPropertyDescriptor(W.prototype,"_handleMouseUp"),W.prototype),W),S=P;function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var F=49*(R.a.calendar.last_year-R.a.calendar.first_year+1),T=v()(R.a.calendar.first_year,R.a.calendar.last_year+1),L={width:"".concat(F,"px")},H={height:"".concat(77,"px")},J=function(e){u()(r,e);var t=j(r);function r(e){var n;return a()(this,r),(n=t.call(this,e))._container=b.a.createRef(),n}return i()(r,[{key:"componentDidMount",value:function(){var e=49*(this.props.selectedYear-R.a.calendar.first_year);this._container.current.scrollLeft=e}},{key:"render",value:function(){var e=this.props,t=e.onMouseOut,r=e.onMouseOverYear,n=e.onMouseUpDate,a=e.distribution,o=e.highlightedYear,i=e.selectedYear,s=e.url;return b.a.createElement("div",{className:"sparkline-container container",ref:this._container,onMouseOut:t},b.a.createElement("div",{className:"sparkline",style:L},b.a.createElement("div",{id:"wm-graph-anchor"},b.a.createElement("div",{id:"wm-ipp-sparkline",style:H,title:"Explore captures for this URL"},b.a.createElement(B,{distribution:a,imgWidth:F,imgHeight:75,firstYear:R.a.calendar.first_year,selectedYear:i,monthWidth:4,yearWidth:49,onMouseOverDate:r,onMouseUpDate:n}),o&&b.a.createElement("div",{className:"sparkline-mouse-highlight",style:{width:"49px",height:"75px",left:49*(o-R.a.calendar.first_year)}}))),b.a.createElement("div",{id:"year-labels"},T.map((function(e){return b.a.createElement(S,{key:e,highlighted:e===o,selected:e===i,onMouseOver:r,onMouseUpDate:n,url:s,year:e})})))))}}]),r}(b.a.Component);d()(J,"displayName","Sparkline"),d()(J,"propTypes",{distribution:M.a.object,highlightedMonth:M.a.number,highlightedYear:M.a.number,selectedYear:M.a.number,url:M.a.string.isRequired,onMouseOut:M.a.func,onMouseOverYear:M.a.func.isRequired,onMouseUpDate:M.a.func.isRequired})}}]);
//# sourceMappingURL=sparkline.fd39cd1714901e735f7f.chunk.js.map
// @license-end
